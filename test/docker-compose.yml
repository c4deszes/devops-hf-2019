version: "3.5"
services:
  consul:
    image: consul
    command: [ "agent", "-server", "-ui", "-node=server-1", "-bootstrap-expect=1", "-client=0.0.0.0" ]
    networks:
      - local
  jvm:
    image: devops-hf/chat-service:jvm
    depends_on: 
      - consul
    environment: 
      - 'consul.host=consul'
      - 'chat.kill-empty=false'
    ports:
      - '3001:8080/tcp'
    networks:
      - local
  native:
    image: devops-hf/chat-service:native
    depends_on: 
      - consul
    environment: 
      - 'consul.host=consul'
      - 'chat.kill-empty=false'
    ports:
      - '3002:8080/tcp'
    networks:
      - local
networks:
  local:
    name: local
    driver: bridge